"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[604],{8802:function(e,n,t){t.d(n,{K7:function(){return o},Ov:function(){return c},RB:function(){return d},T5:function(){return l},Vl:function(){return i},Y:function(){return r},df:function(){return u},kJ:function(){return a},rj:function(){return s},uI:function(){return m}});var a=[{name:"label",schema:["STRING"]},{name:"key",schema:["STRING"]},{name:"type",schema:["STRING"]},{name:"size",schema:["STRING"]},{name:"shape",schema:["STRING"]},{name:"icon",schema:["STRING"]},{name:"actionType",schema:["STRING"]},{name:"link",schema:["STRING"]},{name:"onClick",schema:["FUNCTION"]},{name:"service",schema:["STRING"]},{name:"params",schema:["JSON"]},{name:"callback",schema:["FUNCTION"]},{name:"danger",schema:["BOOLEAN"]},{name:"ghost",schema:["BOOLEAN"]},{name:"confirmRequired",schema:["BOOLEAN"]},{name:"confirmText",schema:["STRING"]},{name:"accessRequired",schema:["BOOLEAN"]},{name:"accessKey",schema:["STRING"]}],r=[{name:"label",schema:["STRING"]},{name:"span",schema:["NUMBER","STRING"]},{name:"value",schema:["JSON"]},{name:"onClick",schema:["FUNCTION"]}],i=[{name:"label",schema:["STRING"]},{name:"key",schema:["STRING"]},{name:"children",schema:["COMPONENT"]},{name:"forceRender",schema:["BOOLEAN"]},{name:"closable",schema:["BOOLEAN"]},{name:"disabled",schema:["BOOLEAN"]},{name:"destroyInactiveTabPane",schema:["BOOLEAN"]}],s=[{name:"label",schema:["STRING"]},{name:"key",schema:["STRING"]},{name:"value",schema:["STRING"]}],c=[{name:"target",schema:["STRING"]},{name:"title",schema:["STRING"]},{name:"description\t",schema:["STRING"]},{name:"arrow",schema:["BOOLEAN"]},{name:"mask",schema:["BOOLEAN"]},{name:"placement",schema:["STRING"]},{name:"type",schema:["STRING"]},{name:"cover",schema:["STRING"]},{name:"onClose",schema:["FUNCTION"]}],l=[{name:"key",schema:["STRING"]},{name:"label",schema:["STRING"]},{name:"collapsible",schema:["STRING"]},{name:"forceRender",schema:["BOOLEAN"]},{name:"showArrow",schema:["BOOLEAN"]},{name:"children",schema:["COMPONENT"]},{name:"extra",schema:["COMPONENT"]}],u=[{name:"label",schema:["STRING"]},{name:"name",schema:["STRING"]},{name:"tooltip",schema:["STRING"]},{name:"size",schema:["STRING"]},{name:"defaultValue",schema:["STRING"]},{name:"placeholder",schema:["STRING"]},{name:"colSize",schema:["NUMBER"]},{name:"widget",schema:["STRING"]},{name:"editable",schema:["BOOLEAN"]},{name:"multiple",schema:["BOOLEAN"]},{name:"readOnly",schema:["BOOLEAN"]},{name:"disabled",schema:["BOOLEAN"]},{name:"options",schema:["JSON"]},{name:"rules",schema:["JSON"]},{name:"reference",schema:["JSON"]},{name:"dependent",schema:["JSON"]}],o=[{name:"title",schema:["STRING"]},{name:"dataIndex",schema:["STRING"]},{name:"tooltip",schema:["STRING"]},{name:"initialValue",schema:["STRING"]},{name:"colSize",schema:["NUMBER"]},{name:"valueType",schema:["STRING"]},{name:"editable",schema:["BOOLEAN"]},{name:"ellipsis",schema:["BOOLEAN"]},{name:"copyable",schema:["BOOLEAN"]},{name:"search",schema:["BOOLEAN"]},{name:"filters",schema:["BOOLEAN"]},{name:"hideInTable",schema:["BOOLEAN"]},{name:"hideInForm",schema:["BOOLEAN"]},{name:"hideInSearch",schema:["BOOLEAN"]},{name:"hideInDescriptions",schema:["BOOLEAN"]},{name:"valueEnum",schema:["JSON"]}],d=[{name:"title",schema:["STRING"]},{name:"dataIndex",schema:["STRING"]},{name:"tooltip",schema:["STRING"]},{name:"valueType",schema:["STRING"]},{name:"editable",schema:["BOOLEAN"]},{name:"ellipsis",schema:["BOOLEAN"]},{name:"copyable",schema:["BOOLEAN"]},{name:"valueEnum",schema:["JSON"]}],m=[{name:"title",schema:["STRING"]},{name:"name",schema:["STRING"]},{name:"dataIndex",schema:["STRING"]},{name:"tooltip",schema:["STRING"]},{name:"initialValue",schema:["STRING"]},{name:"colSize",schema:["NUMBER"]},{name:"type",schema:["STRING"]},{name:"widget",schema:["STRING"]},{name:"valueType",schema:["STRING"]},{name:"operator",schema:["STRING"]},{name:"editable",schema:["BOOLEAN"]},{name:"ellipsis",schema:["BOOLEAN"]},{name:"copyable",schema:["BOOLEAN"]},{name:"search",schema:["BOOLEAN"]},{name:"filters",schema:["BOOLEAN"]},{name:"multiple",schema:["BOOLEAN"]},{name:"hideInTable",schema:["BOOLEAN"]},{name:"hideInForm",schema:["BOOLEAN"]},{name:"hideInSearch",schema:["BOOLEAN"]},{name:"hideInDescriptions",schema:["BOOLEAN"]},{name:"options",schema:["JSON"]},{name:"enums",schema:["JSON"]},{name:"reference",schema:["JSON"]}]},62190:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ce}});var a=t(67825),r=t.n(a),i=t(90228),s=t.n(i),c=t(87999),l=t.n(c),u=t(48305),o=t.n(u),d=t(37956),m=t(70725),p=t(73264),h=t(912),f=t(14471),x=t(31331),v=t(64684),S=t(21621),O=t(74230),I=t(22825),T=t(60247),y=t(11204),N=t(91283),g=t(50959),j=t(38653),E=t(81796),C=t(7733),R=t(28213),Z=t(78809),b=t(26068),w=t.n(b),k=t(33600),P=["id"];function L(e,n){return A.apply(this,arguments)}function A(){return(A=l()(s()().mark((function e(n,t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/materials/material",w()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,n){return _.apply(this,arguments)}function _(){return(_=l()(s()().mark((function e(n,t){var a,i;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.id,i=r()(n,P),e.abrupt("return",(0,k.request)("/api/materials/material/".concat(a),w()({method:"DELETE",params:w()({},i)},t||{})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=["id"];function D(e,n){return M.apply(this,arguments)}function M(){return(M=l()(s()().mark((function e(n,t){var a,i;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.id,i=r()(n,G),e.abrupt("return",(0,k.request)("/api/materials/component/".concat(a),w()({method:"DELETE",params:w()({},i)},t||{})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=l()(s()().mark((function e(n,t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("/api/materials/component/page",w()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=t(16166),V=t(92336),z=t(73115),q=t(89862),J=t(5135),K=t(70346),H=t(41778),Y=t(21686),X=t(28117),W=t(15558),Q=t.n(W),$=t(47113),ee=t(56655),ne=t(17906),te=t(23683),ae=t(30565),re=t(64155),ie=t(83745),se=t(7313),ce=t(20947),le=t(45144),ue=t(89178),oe=t(46611),de=t(8802),me=t(11527),pe=["key","name"],he=["String","Number","Boolean","Function","Json","Text","Multiple","Complex"],fe={INPUT:"INPUT",INPUT_NUMBER:"INPUT_NUMBER",SWITCH:"SWITCH",SELECT:"SELECT",RADIO:"RADIO",CHECKBOX:"CHECKBOX",TEXTAREA:"TEXTAREA",TABLE_COLS:"TABLE_COLS",FORM_ITEMS:"FORM_ITEMS",DESC_ITEMS:"DESC_ITEMS",MENU_ITEMS:"MENU_ITEMS",TAB_ITEMS:"TAB_ITEMS",COMPONENT:"COMPONENT",SELECT_OPTIONS:"SELECT_OPTIONS",TOUR_STEPS:"TOUR_STEPS",COLLAPSE_ITEMS:"COLLAPSE_ITEMS",ICON:"ICON",COMPONENTS:"COMPONENTS",ACTIONS:"ACTIONS",SERVICE:"SERVICE",PRO_DESC_COLS:"PRO_DESC_COLS",PRO_TABLE_COLS:"PRO_TABLE_COLS",PRO_PAGE_COLS:"PRO_PAGE_COLS"},xe=function(e){var n=e.saveCallback,t=e.actionRef,a=(0,g.useState)(!1),i=o()(a,2),c=i[0],u=i[1],d=(0,g.useState)(C.yD.INPUT),m=o()(d,2),p=m[0],h=m[1],x=(0,g.useState)(C.sS.String),S=o()(x,2),O=S[0],I=S[1],T=(0,g.useState)(),N=o()(T,2),j=N[0],E=N[1],R=$.Z.useForm(),Z=o()(R,1)[0];return g.useImperativeHandle(t,(function(){return{open:function(e){u(!0),E(e),I(e.dataType||C.sS.String),h(e.widget||C.yD.INPUT),Z.setFieldsValue(e)},closeView:function(){u(!1)}}})),(0,me.jsx)(ne.Z,{width:720,title:"配置组件属性",placement:"right",destroyOnClose:!0,maskClosable:!0,open:c,extra:(0,me.jsxs)(f.Z,{children:[(0,me.jsx)(v.ZP,{onClick:function(){u(!1)},children:"取消"}),(0,me.jsx)(v.ZP,{type:"primary",onClick:l()(s()().mark((function e(){var t;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.validateFields();case 2:(t=e.sent)&&(n(w()(w()({},j),t)),u(!1),Z.resetFields());case 4:case"end":return e.stop()}}),e)}))),children:"保存"})]}),onClose:function(){u(!1),Z.resetFields()},children:(0,me.jsxs)($.Z,{form:Z,children:[(0,me.jsx)($.Z.Item,{label:"name",name:"name",children:(0,me.jsx)(y.Z,{placeholder:"name"})}),(0,me.jsx)($.Z.Item,{label:"dataType",name:"dataType",children:(0,me.jsx)(le.default,{placeholder:"dataType",onChange:function(e){return I(e)},options:he.map((function(e){return{label:e,value:e}}))})}),(0,me.jsx)($.Z.Item,{label:"widget",name:"widget",children:(0,me.jsx)(le.default,{placeholder:"widget",onChange:function(e){h(e),e===C.yD.ACTIONS?Z.setFieldsValue({schema:de.kJ}):e===C.yD.DESC_ITEMS?Z.setFieldsValue({schema:de.Y}):e===C.yD.TAB_ITEMS?Z.setFieldsValue({schema:de.Vl}):e===C.yD.SELECT_OPTIONS?Z.setFieldsValue({schema:de.rj}):e===C.yD.COLLAPSE_ITEMS?Z.setFieldsValue({schema:de.T5}):e===C.yD.TOUR_STEPS?Z.setFieldsValue({schema:de.Ov}):e===C.yD.PRO_TABLE_COLS?Z.setFieldsValue({schema:de.K7}):e===C.yD.PRO_DESC_COLS?Z.setFieldsValue({schema:de.RB}):e===C.yD.FORM_ITEMS?Z.setFieldsValue({schema:de.df}):e===C.yD.PRO_PAGE_COLS?Z.setFieldsValue({schema:de.uI}):Z.setFieldsValue({schema:[]})},options:Object.entries(fe).map((function(e){var n=o()(e,2);return{label:n[0],value:n[1]}}))})}),(0,me.jsx)($.Z.Item,{label:"description",name:"description",children:(0,me.jsx)(y.Z.TextArea,{rows:2,placeholder:"属性描述"})}),[C.yD.SELECT,C.yD.RADIO,C.yD.CHECKBOX].includes(p)&&(0,me.jsx)($.Z.Item,{label:"options",name:"options",children:(0,me.jsx)(le.default,{mode:"tags",style:{width:"100%"},tokenSeparators:[","]})}),[C.sS.Complex,C.sS.Function].includes(O)&&(0,me.jsx)($.Z.Item,{label:"args",name:"args",children:(0,me.jsx)(le.default,{mode:"tags",style:{width:"100%"},tokenSeparators:[","]})}),O===C.sS.Multiple&&(0,me.jsx)($.Z.Item,{label:"schema",children:(0,me.jsx)(le.default,{mode:"multiple",tokenSeparators:[","],style:{width:"100%"},options:Object.entries(C.PZ).map((function(e){var n=o()(e,2);return{label:n[0],value:n[1]}}))})}),(0,me.jsx)($.Z.Item,{label:"defaultValue",name:"defaultValue",children:(0,me.jsx)(y.Z,{placeholder:"defaultValue"})}),O===C.sS.Complex&&(0,me.jsx)($.Z.Item,{label:"schema",children:(0,me.jsx)($.Z.List,{name:"schema",children:function(e,n){var t=n.add,a=n.remove;return(0,me.jsxs)(me.Fragment,{children:[e.map((function(e){var n=e.key,t=e.name,i=r()(e,pe);return(0,me.jsxs)(f.Z,{style:{display:"flex",marginBottom:1},align:"baseline",children:[(0,me.jsx)($.Z.Item,w()(w()({},i),{},{name:[t,"name"],children:(0,me.jsx)(y.Z,{placeholder:"请输入属性名"})})),(0,me.jsx)($.Z.Item,w()(w()({},i),{},{name:[t,"schema"],rules:[{required:!0,message:"请选择属性类型"}],children:(0,me.jsx)(le.default,{mode:"multiple",placeholder:"请选择属性类型",tokenSeparators:[","],style:{width:300},options:Object.entries(C.PZ).map((function(e){var n=o()(e,2);return{label:n[0],value:n[1]}}))})})),(0,me.jsx)(oe.Z,{onClick:function(){return a(t)}})]},n)})),(0,me.jsx)($.Z.Item,{children:(0,me.jsx)(v.ZP,{type:"dashed",onClick:function(){return t()},block:!0,icon:(0,me.jsx)(z.Z,{}),children:"添 加"})})]})}})}),(0,me.jsx)($.Z.Item,{label:"editable",name:"editable",children:(0,me.jsx)(ue.Z,{})}),(0,me.jsx)($.Z.Item,{label:"required",name:"required",children:(0,me.jsx)(ue.Z,{})})]})})},ve=(0,ae.W6)((function(){return(0,me.jsx)(ie.Z,{style:{cursor:"grab",color:"#999"}})})),Se=[{title:"name",dataIndex:"name"},{title:"dataType",dataIndex:"dataType",valueType:"select",tooltip:"数据类型",valueEnum:C.sS},{title:"widget",dataIndex:"widget",valueType:"select",tooltip:"控件类型",valueEnum:C.yD,width:200},{title:"description",dataIndex:"description",tooltip:"属性描述"},{title:"defaultValue",dataIndex:"defaultValue",tooltip:"属性默认值"},{title:"editable",dataIndex:"editable",valueType:"switch",tooltip:"该属性是否可编辑"},{title:"required",dataIndex:"required",valueType:"switch",tooltip:"属性是否必填"}],Oe=(0,ae.W8)((function(e){return(0,me.jsx)("tr",w()({},e))})),Ie=(0,ae.JN)((function(e){return(0,me.jsx)("tbody",w()({},e))})),Te=function(e){var n=e.saveCallback,t=e.actionRef,a=$.Z.useForm(),r=o()(a,1)[0],i=(0,g.useState)(!1),c=o()(i,2),u=c[0],d=c[1],m=(0,g.useState)(),p=o()(m,2),x=p[0],S=p[1],O=(0,g.useState)([]),I=o()(O,2),T=I[0],y=I[1],j=g.useState(!1),E=o()(j,2),R=E[0],b=E[1],P=(0,g.useState)([]),L=o()(P,2),A=L[0],B=L[1],_=g.useState([]),G=o()(_,2),D=G[0],M=G[1],F=g.useState([]),V=o()(F,2),z=V[0],q=V[1],J=g.useRef(null),K=(0,k.useRequest)(Z.an,{manual:!0,onSuccess:function(e){y(e||[])}}),H=K.loading,Y=K.run,X=K.refresh;(0,g.useImperativeHandle)(t,(function(){return{open:(e=l()(s()().mark((function e(n){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(n),Y({componentId:n.id}),q(n.actions||[]),r.setFieldsValue(n),d(!0);case 5:case"end":return e.stop()}}),e)}))),function(n){return e.apply(this,arguments)})};var e}));var W,ae,ie,le=g.useMemo((function(){return A.length?Se:[{title:"Sort",dataIndex:"sort",width:60,className:"drag-visible",render:function(){return(0,me.jsx)(ve,{})}}].concat(Se)}),[A]);return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(ne.Z,{width:1480,placement:"right",title:"配置组件属性-".concat(null==x?void 0:x.name),destroyOnClose:!0,forceRender:!0,open:u,onClose:function(){d(!1)},styles:{body:{padding:12}},children:(0,me.jsxs)(f.Z,{direction:"vertical",style:{width:"100%"},children:[(0,me.jsx)(h.Z,{title:"基础信息",size:"small",children:(0,me.jsxs)(se.vY,{editable:{onSave:(ie=l()(s()().mark((function e(t,a){var r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.np)(w()({id:null==x?void 0:x.id},a));case 2:null!=(r=e.sent)&&r.success&&(ee.ZP.success("保存成功"),null==n||n());case 4:case"end":return e.stop()}}),e)}))),function(e,n){return ie.apply(this,arguments)})},children:[(0,me.jsx)(se.vY.Item,{label:"组件命名",dataIndex:"name",children:null==x?void 0:x.name}),(0,me.jsx)(se.vY.Item,{label:"组件标题",dataIndex:"title",children:null==x?void 0:x.title}),(0,me.jsx)(se.vY.Item,{label:"物料库包名",dataIndex:"package",children:null==x?void 0:x.package}),(0,me.jsx)(se.vY.Item,{label:"是否默认包",dataIndex:"defaulted",valueType:"switch",children:null==x?void 0:x.defaulted}),(0,me.jsx)(se.vY.Item,{label:"文档地址",dataIndex:"documentUrl",children:null==x?void 0:x.documentUrl})]})}),(0,me.jsx)(h.Z,{title:"Props",size:"small",children:(0,me.jsx)(ce.Z,{loading:H,columns:[].concat(Q()(le),[{title:"操作",valueType:"option",width:160,render:function(e,n,t,a){return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(v.ZP,{danger:!0,type:"link",size:"small",onClick:function(){var e;null===(e=J.current)||void 0===e||e.open(n)},children:"高级"},"advance"),(0,me.jsx)(v.ZP,{type:"link",size:"small",onClick:function(){var e;null==a||null===(e=a.startEditable)||void 0===e||e.call(a,n.uuid)},children:"编辑"},"editable"),(0,me.jsx)(N.Z,{title:"确认删除该记录？",onConfirm:l()(s()().mark((function e(){var t;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.id){e.next=9;break}return b(!0),e.next=4,(0,Z.HU)({ids:[n.id]});case 4:t=e.sent,b(!1),null!=t&&t.success&&X(),e.next=10;break;case 9:y((function(e){return e.filter((function(e){return e.uuid!==n.uuid}))}));case 10:case"end":return e.stop()}}),e)}))),onCancel:function(){},children:(0,me.jsx)(v.ZP,{danger:!0,type:"link",size:"small",loading:R,children:"删除"},"delete")})]})}}]),rowKey:function(e){return e.uuid},value:T,onChange:y,components:A.length>0?void 0:{body:{wrapper:function(e){return(0,me.jsx)(Ie,w()({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:function(){var e=l()(s()().mark((function e(n){var t,a,r,i;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.oldIndex,a=n.newIndex,t===a){e.next=8;break}return r=(0,te.q)(T,t,a),y(r.filter((function(e){return!!e}))),e.next=6,(0,Z.TP)(r);case 6:200===(null==(i=e.sent)?void 0:i.code)&&ee.ZP.success("保存成功");case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},e))},row:function(e){var n=null==T?void 0:T.findIndex((function(n){return n.uuid===e["data-row-key"]}));return(0,me.jsx)(Oe,w()({index:n},e))}}},recordCreatorProps:{newRecordType:"dataSource",record:function(){return{uuid:(0,re.Z)(),name:"",editable:!0,dataType:"String",widget:"INPUT",propType:"DEFAULT",order:0}}},editable:{type:"single",editableKeys:A,actionRender:function(e,n,t){return[t.save,t.cancel,t.delete]},onValuesChange:function(e,n){y(n)},onChange:B,onSave:(ae=l()(s()().mark((function e(t,a){var r,i;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=(0,U.e7)(a,["index","componentId"])).widget===C.yD.ACTIONS?Object.assign(r,{schema:de.kJ}):r.widget===C.yD.DESC_ITEMS?Object.assign(r,{schema:de.Y}):r.widget===C.yD.TAB_ITEMS?Object.assign(r,{schema:de.Vl}):r.widget===C.yD.SELECT_OPTIONS?Object.assign(r,{schema:de.rj}):r.widget===C.yD.COLLAPSE_ITEMS?Object.assign(r,{schema:de.T5}):r.widget===C.yD.TOUR_STEPS?Object.assign(r,{schema:de.Ov}):r.widget===C.yD.PRO_TABLE_COLS?Object.assign(r,{schema:de.K7}):r.widget===C.yD.PRO_DESC_COLS?Object.assign(r,{schema:de.RB}):r.widget===C.yD.FORM_ITEMS?Object.assign(r,{schema:de.df}):r.widget===C.yD.PRO_PAGE_COLS?Object.assign(r,{schema:de.uI}):Object.assign(r,{schema:[]}),null==a||!a.id){e.next=8;break}return e.next=5,(0,Z.aU)(r);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,(0,Z.T4)(w()(w()({},r),{},{componentId:null==x?void 0:x.id}));case 10:e.t0=e.sent;case 11:null!=(i=e.t0)&&i.success&&(ee.ZP.success("保存成功"),null==n||n());case 13:case"end":return e.stop()}}),e)}))),function(e,n){return ae.apply(this,arguments)})}})}),(0,me.jsx)(h.Z,{title:"Ref Actions",size:"small",children:(0,me.jsx)(ce.Z,{columns:[{dataIndex:"name",title:"name"},{dataIndex:"type",title:"type"},{dataIndex:"description",title:"description"},{title:"操作",valueType:"option",width:160,render:function(e,n,t,a){return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(v.ZP,{type:"link",size:"small",onClick:function(){var e;null==a||null===(e=a.startEditable)||void 0===e||e.call(a,n.uuid)},children:"编辑"},"editable"),(0,me.jsx)(N.Z,{title:"确认删除该记录？",onConfirm:l()(s()().mark((function e(){var t,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z.filter((function(e){return e.uuid!==n.uuid})),e.next=3,(0,Z.np)({id:null==x?void 0:x.id,actions:t});case 3:null!=(a=e.sent)&&a.success&&(ee.ZP.success("保存成功"),X());case 5:case"end":return e.stop()}}),e)}))),onCancel:function(){},children:(0,me.jsx)(v.ZP,{danger:!0,type:"link",size:"small",loading:R,children:"删除"},"delete")})]})}}],rowKey:function(e){return e.uuid},value:z,onChange:q,recordCreatorProps:{newRecordType:"dataSource",record:function(){return{uuid:(0,re.Z)(),name:"",type:"",order:(null==z?void 0:z.length)+1}}},editable:{type:"single",editableKeys:D,actionRender:function(e,n,t){return[t.save,t.cancel,t.delete]},onValuesChange:function(e,n){q(n)},onChange:M,onSave:(W=l()(s()().mark((function e(n,t){var a,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=z.map((function(e){return e.uuid===t.uuid?w()(w()({},e),t):e})),e.next=3,(0,Z.np)({id:null==x?void 0:x.id,actions:a});case 3:null!=(r=e.sent)&&r.success&&(ee.ZP.success("保存成功"),X());case 5:case"end":return e.stop()}}),e)}))),function(e,n){return W.apply(this,arguments)})}})})]})}),(0,me.jsx)(xe,{actionRef:J,saveCallback:function(){var e=l()(s()().mark((function e(t){var a,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,U.e7)(t,["index","componentId"]),e.next=3,(0,Z.aU)(a);case 3:null!=(r=e.sent)&&r.success&&(ee.ZP.success("保存成功"),null==n||n(),X());case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})]})},ye=t(35363),Ne=t(37348),ge=t(8880),je=function(e){var n=e.saveCallback,t=e.actionRef,a=d.Z.useApp().message,r=(0,g.useState)(!1),i=o()(r,2),c=i[0],u=i[1],m=(0,g.useState)(!1),p=o()(m,2),h=p[0],x=p[1],S=(0,g.useState)(),O=o()(S,2),I=O[0],T=O[1],y=(0,g.useState)([]),N=o()(y,2),j=N[0],E=N[1],C=g.useState([]),R=o()(C,2),b=R[0],w=R[1],P=(0,k.useRequest)(Z.Or,{manual:!0,onSuccess:function(e){E(e||[])}}),A=P.run,B=P.loading,_=(0,k.useRequest)(Z.OB,{manual:!0,onSuccess:function(e){w((null==e?void 0:e.map((function(e){return e.uuid})))||[])}}).run;return g.useImperativeHandle(t,(function(){return{open:(e=l()(s()().mark((function e(){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(!0),Promise.all([_(),A()]);case 2:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})};var e})),(0,me.jsx)(ye.Z,{width:800,title:"导入官方物料库",open:c,onCancel:function(){u(!1)},footer:(0,me.jsxs)(f.Z,{children:[(0,me.jsx)(v.ZP,{onClick:function(){u(!1)},children:"取消"}),(0,me.jsx)(v.ZP,{type:"primary",loading:h,onClick:l()(s()().mark((function e(){var t,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I){e.next=3;break}return a.error("请选择物料库"),e.abrupt("return");case 3:return e.prev=3,x(!0),e.next=7,L({name:I.name,package:I.pkg,title:I.title,alias:I.alias,uuid:I.uuid,materialId:I.id});case 7:if(null==(t=e.sent)||!t.success||!t.data){e.next=13;break}return e.next=11,(0,Z.ew)({material:t.data.id});case 11:null!=(r=e.sent)&&r.success&&(a.success("同步成功"),null==n||n(I),u(!1));case 13:return e.prev=13,x(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,,13,16]])}))),children:"确定"})]}),children:(0,me.jsx)(Ne.Z,{spinning:B,children:(0,me.jsx)(ge.Z.Group,{onChange:function(e){var n=j.find((function(n){return n.id===e}));T(n)},children:j.map((function(e){return(0,me.jsx)(ge.Z,{size:"small",title:null!=b&&b.includes(e.uuid)?"".concat(e.name,"(已导入)"):e.name,description:e.title,value:e.id,disabled:null==b?void 0:b.includes(e.uuid)},e.id)}))})})})},Ee=["current","pageSize","keyword"],Ce=function(){var e=d.Z.useApp(),n=e.message,t=e.modal,a=g.useState(""),i=o()(a,2),c=i[0],u=i[1],b=g.useState(),w=o()(b,2),P=w[0],L=w[1],A=g.useRef(),_=g.useRef(),G=g.useRef(),M=g.useRef(),W=g.useRef(),Q=(0,k.useRequest)(Z.Z7,{onSuccess:function(e){var n,t;P||(L(null==e?void 0:e[0]),null===(n=A.current)||void 0===n||null===(t=n.reload)||void 0===t||t.call(n))}}),$=Q.data,ee=Q.loading,ne=Q.refresh;return(0,me.jsx)(R.Z,{activateKey:C.z_.MATERIALS,children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)(m.Z,{children:[(0,me.jsx)(p.Z,{span:4,style:{paddingRight:6},children:(0,me.jsx)(h.Z,{title:"物料库",loading:ee,styles:{body:{padding:12,height:"83vh",overflowY:"auto"},header:{paddingRight:12}},extra:(0,me.jsxs)(f.Z,{children:[(0,me.jsx)(x.Z,{title:"导入官方物料库",children:(0,me.jsx)(v.ZP,{ghost:!0,type:"primary",icon:(0,me.jsx)(V.Z,{}),onClick:function(){var e;null===(e=M.current)||void 0===e||e.open()}})}),(0,me.jsx)(x.Z,{title:"新增物料库",children:(0,me.jsx)(v.ZP,{type:"primary",icon:(0,me.jsx)(z.Z,{}),onClick:function(){var e;null===(e=_.current)||void 0===e||e.callCreateView()}})})]}),children:(null==$?void 0:$.length)>0?(0,me.jsx)(S.Z,{style:{width:"100%",borderRight:"none"},selectedKeys:P?[P.uuid]:[],mode:"inline",items:null==$?void 0:$.map((function(e){return{key:e.uuid,style:{padding:12},label:(0,me.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,me.jsx)(O.Z.Text,{strong:!0,children:e.name}),(0,me.jsx)(I.Z,{trigger:["click"],menu:{items:[{label:"同步",key:"sync",icon:(0,me.jsx)(q.Z,{}),onClick:(c=l()(s()().mark((function t(a){var r,i;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.domEvent.stopPropagation(),r=n.loading("正在同步中..."),t.next=5,(0,Z.ew)({material:e.id});case 5:null!=(i=t.sent)&&i.success&&(r(),n.success("同步成功"),ne());case 7:case"end":return t.stop()}}),t)}))),function(e){return c.apply(this,arguments)})},{label:"编辑",key:"edit",icon:(0,me.jsx)(J.Z,{}),onClick:(i=l()(s()().mark((function n(t){var a;return s()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.domEvent.stopPropagation(),null===(a=_.current)||void 0===a||a.callUpdateView({record:e});case 3:case"end":return n.stop()}}),n)}))),function(e){return i.apply(this,arguments)})},{label:"删除",danger:!0,key:"delete",icon:(0,me.jsx)(K.Z,{}),onClick:(r=l()(s()().mark((function a(r){return s()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r.domEvent.stopPropagation(),t.confirm({title:"确认要删除该物料库吗？",onOk:function(){var t=l()(s()().mark((function t(){var a;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B({id:e.id});case 2:null!=(a=t.sent)&&a.success&&(n.success("保存成功"),e.id===(null==P?void 0:P.id)&&L(void 0),ne());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 3:case"end":return a.stop()}}),a)}))),function(e){return r.apply(this,arguments)})}]},children:(0,me.jsx)(v.ZP,{size:"small",color:"default",variant:"filled",icon:(0,me.jsx)(H.Z,{style:{fontSize:16}}),onClick:function(e){e.stopPropagation()}})},"options")]}),onClick:(a=l()(s()().mark((function n(){var t;return s()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:L(e),null===(t=A.current)||void 0===t||t.reload();case 2:case"end":return n.stop()}}),n)}))),function(){return a.apply(this,arguments)})};var a,r,i,c}))}):(0,me.jsx)(T.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:60},description:(0,me.jsx)(O.Z.Text,{strong:!0,children:"还没有物料库，请先创建物料库或者导入官方物料库"}),children:(0,me.jsxs)(f.Z,{direction:"vertical",children:[(0,me.jsx)(v.ZP,{ghost:!0,type:"primary",icon:(0,me.jsx)(V.Z,{}),onClick:function(){var e;null===(e=M.current)||void 0===e||e.open()},children:"导入物料库"}),(0,me.jsx)(v.ZP,{type:"primary",icon:(0,me.jsx)(z.Z,{}),onClick:function(){var e;null===(e=_.current)||void 0===e||e.callCreateView()},children:"创建物料库"})]})})})}),(0,me.jsx)(p.Z,{span:20,children:(0,me.jsx)(h.Z,{title:"组件列表",styles:{body:{padding:12,height:"83vh",overflowY:"auto"}},extra:(0,me.jsxs)(f.Z,{children:[(0,me.jsx)(y.Z.Search,{value:c,style:{width:360},placeholder:"组件名称/标题",enterButton:(0,me.jsx)(v.ZP,{type:"primary",icon:(0,me.jsx)(Y.Z,{})}),onChange:function(e){return u(e.target.value)}}),(0,me.jsx)(v.ZP,{type:"primary",icon:(0,me.jsx)(z.Z,{}),onClick:function(){var e;null===(e=G.current)||void 0===e||e.callCreateView({params:{materialId:null==P?void 0:P.id,materialName:null==P?void 0:P.name}})},children:"新增物料组件"})]}),children:P?(0,me.jsx)(X.Z,{rowKey:"id",size:"small",actionRef:A,tableAlertOptionRender:!1,tableAlertRender:!1,loading:ee,toolBarRender:!1,search:!1,params:{keyword:c,materialId:P.id},pagination:{pageSize:18},request:function(e){var n=e.current,t=void 0===n?1:n,a=e.pageSize,i=e.keyword,s=r()(e,Ee);return i&&Object.assign(s,{OR:[{name:{contains:i}},{title:{contains:i}}]}),function(e,n){return F.apply(this,arguments)}({pageSize:a,current:t,where:(0,U.kL)(s)})},columns:[{title:"组件命名",dataIndex:"name"},{title:"组件标题",dataIndex:"title"},{title:"包名称",dataIndex:"package",search:!1},{title:"文档链接",dataIndex:"documentUrl",search:!1},{title:"操作",valueType:"option",width:140,render:function(e,n){return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(v.ZP,{size:"small",type:"link",onClick:function(){var e;null===(e=W.current)||void 0===e||e.open(n)},children:"组件配置"}),(0,me.jsx)(N.Z,{title:"确认要删除该物料组件吗",onConfirm:l()(s()().mark((function e(){var t,a,r;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D({id:null===(t=n.id)||void 0===t?void 0:t.toString()});case 2:null!=(a=e.sent)&&a.success&&(null===(r=A.current)||void 0===r||r.reload());case 4:case"end":return e.stop()}}),e)}))),children:(0,me.jsx)(v.ZP,{danger:!0,size:"small",type:"link",children:"删除"})})]})}}]}):(0,me.jsx)(T.Z,{})})})]}),(0,me.jsx)(j.Z,{}),(0,me.jsx)(Te,{actionRef:W,saveCallback:function(){var e;null===(e=A.current)||void 0===e||e.reload()}}),(0,me.jsx)(je,{actionRef:M,saveCallback:l()(s()().mark((function e(){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:null===(n=A.current)||void 0===n||n.reload();case 3:case"end":return e.stop()}}),e)})))}),(0,me.jsx)(E.Z,{title:"编辑物料库",columns:[{title:"物料库名称",name:"name",dataIndex:"name"},{title:"物料库包名",name:"package",dataIndex:"package"},{title:"文档地址",name:"url",dataIndex:"url"}],actionRef:_,path:"api/materials/material",saveCallback:l()(s()().mark((function e(){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:null===(n=A.current)||void 0===n||n.reload();case 3:case"end":return e.stop()}}),e)})))}),(0,me.jsx)(E.Z,{title:"编辑物料组件",actionRef:G,path:"api/materials/component",columns:[{title:"组件命名",name:"name",dataIndex:"name"},{title:"组件标题",name:"title",dataIndex:"title"},{title:"物料库包名",name:"package",dataIndex:"package"},{title:"文档地址",name:"documentUrl",dataIndex:"documentUrl"},{title:"是否默认包",name:"defaulted",dataIndex:"defaulted",widget:C.l9.SWITCH}],saveCallback:l()(s()().mark((function e(){var n;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:null===(n=A.current)||void 0===n||n.reload();case 3:case"end":return e.stop()}}),e)})))})]})})}},78809:function(e,n,t){t.d(n,{HU:function(){return v},OB:function(){return l},Or:function(){return o},T4:function(){return x},TP:function(){return h},Z7:function(){return u},aU:function(){return f},an:function(){return m},ew:function(){return d},np:function(){return p}});var a=t(67825),r=t.n(a),i=t(92447),s=["id"],c=["id"],l=function(e){return i.ZP.post("api/materials/material/list",e)},u=function(e){return i.ZP.post("api/materials/material/list",e)},o=function(){return i.ZP.get("api/materials/material/treadstone")},d=function(e){var n=e.material;return i.ZP.post("api/materials/material/".concat(n,"/migrate"))},m=function(e){return i.ZP.post("api/materials/component-props/list",e)},p=function(e){var n=e.id,t=r()(e,s);return i.ZP.patch("api/materials/component/".concat(n,"/"),t)},h=function(e){return i.ZP.post("api/materials/component-props/reorder/",{props:e})},f=function(e){var n=e.id,t=r()(e,c);return i.ZP.patch("api/materials/component-props/".concat(n,"/"),t)},x=function(e){return i.ZP.post("api/materials/component-props/",e)},v=function(e){return i.ZP.post("api/materials/component-props/delete",e)}},16166:function(e,n,t){t.d(n,{XV:function(){return o},c7:function(){return p},e7:function(){return m},kL:function(){return d},pM:function(){return u}});var a=t(335),r=t.n(a),i=t(26068),s=t.n(i),c=t(82092),l=t.n(c),u=function(e){try{return JSON.parse(e),!0}catch(e){return!1}},o=function(e){var n;return/[A-Za-z]/.test(null==e?void 0:e.substring(0,1))?null==e||null===(n=e.substring(0,1))||void 0===n?void 0:n.toUpperCase():null==e?void 0:e.substring(0,1)},d=function(e){return Object.keys(e).reduce((function(n,t){return null!==e[t]&&""!==e[t]?Object.assign(n,l()({},t,e[t])):n}),{})},m=function(e,n){var t,a=s()({},e),i=r()(n);try{for(i.s();!(t=i.n()).done;){var c=t.value;a.hasOwnProperty(c)&&delete a[c]}}catch(e){i.e(e)}finally{i.f()}return a},p=function(e,n){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.onload=function(){console.log("Script loaded: ".concat(e)),n&&n()},t.onerror=function(){console.error("Failed to load script: ".concat(e))},document.head.appendChild(t)}}}]);